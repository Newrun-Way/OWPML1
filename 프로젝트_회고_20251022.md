 프로젝트 회고 일지 - 2025년 10월 22일

 작업 개요
OWPML 필터를 활용한 한글 문서(HWP/HWPX) 추출 시스템 개발 및 프로젝트 초기 구성 완료


 주요 성과

 1. 문서 추출 시스템 구축
- HWPX 추출: 텍스트, 표 구조, 이미지 모두 추출 가능
- HWP 텍스트 추출: 기본 텍스트 추출 지원
- 자동 파일 형식 감지: 하나의 스크립트로 HWP/HWPX 모두 처리

 2. 핵심 기능 구현
```
입력: HWP 또는 HWPX 파일
처리: 자동 형식 감지 및 최적 추출
출력:
  - 전체텍스트.txt
  - 표데이터.json (RAG 적용 가능)
  - 표목록.txt
  - 구조.json
  - 이미지 파일들 (HWPX만)
```

 3. 실제 테스트 결과
- **교통안전현황분석 리포트.hwpx**: 
  - 319개 단락, 99개 표 완벽 추출
  - 5,284자 텍스트 추출
- **디지털정부 발전유공 포상 추진계획.hwpx**:
  - 1,061개 단락, 44개 표, 2개 이미지 추출
  - 26,839자 텍스트 추출


 기술적 성과

 통합 스크립트 개발 (extract.py)
```powershell
python extract.py "파일경로"
```
- 단 한 줄로 모든 추출 작업 수행
- HWP/HWPX 자동 구분
- JSON 형식으로 표 데이터 출력 (RAG 시스템 직접 활용 가능)

 프로젝트 단순화
- **이전**: 7개 스크립트 + 3개 가이드 = 10개 파일
- **현재**: 1개 스크립트 + 1개 가이드 = 2개 파일
- **결과**: 80% 단순화, 사용성 대폭 개선


 기술 스택

| 구분 | 기술 |
|
| 언어 | Python 3.13 |
| 문서 처리 | OWPML, hwpxlib, hwplib |
| Java 브릿지 | JPype1 |
| 데이터 형식 | JSON, XML |
| 버전 관리 | Git |


 프로젝트 구조

```
OWPML1/
├── extract.py                  핵심 추출 스크립트
├── README.md                   프로젝트 문서
├── WeeklyPlan.md               8주 계획서
├── python-hwpxlib/             HWPX 처리 라이브러리
├── python-hwplib/              HWP 처리 라이브러리
└── hwp data/                   테스트 문서
```


 문제 해결 과정

 1. 빌드 환경 문제
- **문제**: hwpx-owpml-model의 C++ 빌드 실패
- **해결**: Python 기반 라이브러리(python-hwpxlib/hwplib)로 대체
- **결과**: Windows에서 바로 실행 가능

 2. 인코딩 문제
- **문제**: HWP 텍스트 출력 시 한글 깨짐 (cp949 오류)
- **해결**: UTF-8 출력 스트림 설정
```python
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')
```

 3. 스크립트 복잡도
- **문제**: 여러 개의 추출 스크립트로 사용자 혼란
- **해결**: 통합 스크립트로 단순화
- **결과**: 사용성 80% 개선

 4. GitHub 푸시 권한 문제
- **문제**: 403 Write access denied
- **원인**: Personal Access Token 필요
- **해결**: PAT 생성 및 새 저장소(OWPML1) 생성으로 해결


 RAG 프로젝트 적용 가능성

 표 데이터 활용
```json
{
  "id": 0,
  "type": "table",
  "summary": "표 9: 9행 × 4열",
  "rows": [
    ["구분", "항목", "설명", "배점"],
    ["공통지표(40)", "국가발전 기여도", "...", "10"]
  ]
}
```

 장점
1. **구조화된 데이터**: 표를 JSON으로 저장하여 직접 활용 가능
2. **텍스트 분리**: 일반 텍스트와 표 데이터를 별도 인덱싱
3. **검색 품질 향상**: 표 구조를 유지하여 정확한 정보 검색


 향후 계획

 단기 (1-2주)
- [ ] 더 많은 문서로 테스트
- [ ] 오류 처리 개선
- [ ] 추출 성능 측정

 중기 (3-4주)
- [ ] RAG 시스템 통합
- [ ] 벡터 DB 연동 (FAISS/Pinecone)
- [ ] 질의응답 챗봇 프로토타입

 장기 (5-8주)
- [ ] 웹 인터페이스 개발
- [ ] 배치 처리 기능
- [ ] API 서버 구축


 배운 점

 기술적 학습
1. **OWPML 구조 이해**: XML 기반 한글 문서 포맷
2. **Python-Java 연동**: JPype1을 통한 라이브러리 활용
3. **문서 구조 분석**: 단락, 표, 이미지 구분 및 추출

 프로젝트 관리
1. **점진적 개선**: 복잡한 스크립트를 단순화하는 과정
2. **사용자 중심 설계**: 명령어 하나로 모든 작업 완료
3. **문서화의 중요성**: README와 가이드 작성


 팀 공유 사항

 GitHub 저장소
- **URL**: https://github.com/Newrun-Way/OWPML1
- **브랜치**: main
- **커밋**: "feat: OWPML 한글 문서 추출 프로젝트 초기 구성"

 실행 방법
```powershell
cd python-hwpxlib
python extract.py "문서파일.hwpx"
```

 필요 환경
- Python 3.7+
- Java (JDK 8+)
- JPype1: `pip install JPype1`


 개선 필요 사항

 기능
- [ ] 에러 메시지 개선 (더 명확한 안내)
- [ ] 진행 상황 표시 (큰 파일 처리 시)
- [ ] 로그 기능 추가

 성능
- [ ] 대용량 파일 처리 최적화
- [ ] 메모리 사용량 모니터링
- [ ] 병렬 처리 검토

 문서
- [ ] API 문서 작성
- [ ] 더 많은 사용 예시
- [ ] 트러블슈팅 가이드


 마무리

오늘 OWPML 프로젝트의 핵심 기능을 완성하고 팀과 공유할 수 있는 상태로 만들었습니다. 
특히 하나의 통합 스크립트로 HWP/HWPX 모두 처리할 수 있게 되어 사용성이 크게 개선되었고, 
표 데이터를 JSON으로 추출하여 RAG 시스템에 바로 적용할 수 있는 구조를 갖추었습니다.

다음 단계는 실제 RAG 시스템과의 통합 및 질의응답 챗봇 프로토타입 개발입니다.


**작성자**: Donghoon Cho  
**작성일**: 2025년 10월 22일  
**프로젝트**: OWPML 필터를 활용한 한글 문서 기반 질의응답 서비스

